
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>geoips.interfaces.module_based.output_checkers &#8212; GeoIPS, Geolocated Information Processing System 1.17.0a0.post13.dev0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/set_width.css?v=d4af5e1e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js?v=b70c9869"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/geoips/interfaces/module_based/output_checkers';</script>
    <link rel="icon" href="../../../../_static/nrlicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.1" />
    <meta name="docbuild:last-update" content="Jul 15, 2025 18:42:09"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/NRL_logo_RGB.jpg" class="logo__image only-light" alt="GeoIPS, Geolocated Information Processing System 1.17.0a0.post13.dev0 documentation - Home"/>
    <img src="../../../../_static/NRL_logo_sidebar_Reverse.png" class="logo__image only-dark pst-js-only" alt="GeoIPS, Geolocated Information Processing System 1.17.0a0.post13.dev0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../getting-started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../concepts/index.html">
    Concepts
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../contribute/index.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../geoips_api/index.html">
    API
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../../releases/index.html">
    Release Notes
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../../contact/index.html">
    About Us
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NRLMMD-GEOIPS/geoips" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../getting-started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../concepts/index.html">
    Concepts
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../contribute/index.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../geoips_api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../releases/index.html">
    Release Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../contact/index.html">
    About Us
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NRLMMD-GEOIPS/geoips" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">geoips.interfaces.module_based.output_checkers</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for geoips.interfaces.module_based.output_checkers</h1><div class="highlight"><pre>
<span></span><span class="c1"># # # This source code is subject to the license referenced at</span>
<span class="c1"># # # https://github.com/NRLMMD-GEOIPS.</span>

<span class="sd">&quot;&quot;&quot;Output Checkers interface module.&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">geoips.interfaces.base</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">BaseModuleInterface</span><span class="p">,</span>
    <span class="n">BaseModulePlugin</span><span class="p">,</span>
    <span class="n">ValidationError</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="c1"># import subprocess</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">geoips.commandline.log_setup</span><span class="w"> </span><span class="kn">import</span> <span class="n">log_with_emphasis</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gzip</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">glob</span><span class="w"> </span><span class="kn">import</span> <span class="n">glob</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">exists</span><span class="p">,</span> <span class="n">splitext</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">isdir</span><span class="p">,</span> <span class="n">join</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">os</span><span class="w"> </span><span class="kn">import</span> <span class="n">makedirs</span><span class="p">,</span> <span class="n">getenv</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shutil</span><span class="w"> </span><span class="kn">import</span> <span class="n">copyfileobj</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">geoips.filenames.base_paths</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_dirs</span>


<span class="n">LOG</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">rezip</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="write_bad_comparisons_to_file"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.write_bad_comparisons_to_file">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">write_bad_comparisons_to_file</span><span class="p">(</span><span class="n">badcomps</span><span class="p">,</span> <span class="n">compare_products</span><span class="p">,</span> <span class="n">compare_strings</span><span class="p">,</span> <span class="n">diffdir</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write text file with cp commands to update products with bad comparisons.</span>

<span class="sd">    Write a text file that can be sourced to replace test output comparison files</span>
<span class="sd">    with the most recent outputs when the output checker returns a bad comparisons.</span>

<span class="sd">    When GeoIPS is updated in a way that changes the imagery and those changes</span>
<span class="sd">    are expected, the integration test image comparisons will fail. This</span>
<span class="sd">    function writes a file named `cp_BADCOMPARES.txt` which can be</span>
<span class="sd">    sourced to copy the new comparison files into place, overwriting</span>
<span class="sd">    the previous comparison files. This allows easily updating the test</span>
<span class="sd">    comparison outputs when code updates make expected changes to the</span>
<span class="sd">    output imagery.</span>

<span class="sd">    We must ensure we also gzip the comparison product in the test outputs</span>
<span class="sd">    directory after copying if the original test comparison output file was</span>
<span class="sd">    gzipped.  If applicable, a gzip command will also be added to</span>
<span class="sd">    cp_BADCOMPARES.txt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    badcomps: list</span>
<span class="sd">        List of files that returned a &quot;BAD COMPARISON&quot; from the output checker.</span>
<span class="sd">        These are the full paths to the files produced during the most recent</span>
<span class="sd">        run.</span>
<span class="sd">    compare_products: dict</span>
<span class="sd">        dictionary of comparison products - including the original comparison</span>
<span class="sd">        product file name, the gunzipped product file path if applicable,</span>
<span class="sd">        and the path to the file that should be used for comparison against</span>
<span class="sd">        &quot;badcomps&quot; files.</span>
<span class="sd">    compare_strings : list of str</span>
<span class="sd">        List of all comparison &quot;tags&quot; included in goodcomps and badcomps lists.</span>

<span class="sd">        * This list is used to remove the comparison tags from goodcomps and</span>
<span class="sd">          badcomps to retrieve only the file path.</span>
<span class="sd">    diffdir: str</span>
<span class="sd">        Full path to write &quot;cp_BADCOMPARES.txt&quot; file.</span>
<span class="sd">        NOTE: diffdir currently also is used to specify the path to the</span>
<span class="sd">        output files. Eventually we should pass in 2 separate paths, one</span>
<span class="sd">        to specify where to write the diff files, and a separate path</span>
<span class="sd">        indicating where to write the updated test output comparison files.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">        Binary code: 0 if all comparisons were completed successfully, non-zero</span>
<span class="sd">        if there were bad comparisons.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">badcompare</span> <span class="ow">in</span> <span class="n">badcomps</span><span class="p">:</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;BADCOMPARE </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">badcompare</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">badcomps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fname_cp</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;cp_BADCOMPARES.txt&quot;</span><span class="p">)</span>
        <span class="n">fname_badcptest</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;cptest_BADCOMPARES.txt&quot;</span><span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span>
            <span class="s2">&quot;BADCOMPARES Commands to copy </span><span class="si">%d</span><span class="s2"> files that had bad comparisons&quot;</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">badcomps</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  source </span><span class="si">{</span><span class="n">fname_badcptest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  source </span><span class="si">{</span><span class="n">fname_cp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Include print statement for easy copy/paste at the command line</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;***</span><span class="se">\n</span><span class="s2">source </span><span class="si">{</span><span class="n">fname_cp</span><span class="si">}</span><span class="se">\n</span><span class="s2">***&quot;</span><span class="p">)</span>
        <span class="n">comparison_path</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
        <span class="n">test_path</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;BADCOMPARES&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname_cp</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobj</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">badcomp</span> <span class="ow">in</span> <span class="n">badcomps</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">compare_strings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">compare_string</span> <span class="ow">in</span> <span class="n">compare_strings</span><span class="p">:</span>
                        <span class="n">badcomp</span> <span class="o">=</span> <span class="n">badcomp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">compare_string</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cp -v </span><span class="si">{</span><span class="n">badcomp</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">comparison_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">comparison_basename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">badcomp</span><span class="p">)</span>
                <span class="n">comparison_filename</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">comparison_path</span><span class="p">,</span> <span class="n">comparison_basename</span><span class="p">)</span>
                <span class="n">comparison_gz_filename</span> <span class="o">=</span> <span class="n">comparison_filename</span> <span class="o">+</span> <span class="s2">&quot;.gz&quot;</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">basename</span><span class="p">(</span><span class="n">comparison_gz_filename</span><span class="p">)</span> <span class="ow">in</span> <span class="n">compare_products</span>
                    <span class="ow">and</span> <span class="n">compare_products</span><span class="p">[</span><span class="n">basename</span><span class="p">(</span><span class="n">comparison_gz_filename</span><span class="p">)][</span>
                        <span class="s2">&quot;gunzipped_comparison&quot;</span>
                    <span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;gzip </span><span class="si">{</span><span class="n">comparison_filename</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname_badcptest</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobj</span><span class="p">:</span>
            <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mkdir </span><span class="si">{</span><span class="n">test_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">badcomp</span> <span class="ow">in</span> <span class="n">badcomps</span><span class="p">:</span>
                <span class="n">badcomp</span> <span class="o">=</span> <span class="n">badcomp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;IMAGE &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="n">badcomp</span> <span class="o">=</span> <span class="n">badcomp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;TEXT &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="n">badcomp</span> <span class="o">=</span> <span class="n">badcomp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;GEOIPS NETCDF &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="n">badcomp</span> <span class="o">=</span> <span class="n">badcomp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;GEOTIFF &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1"># For display purposes - tifs are easier to view</span>
                <span class="n">test_basename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">badcomp</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.jif&quot;</span><span class="p">,</span> <span class="s2">&quot;.tif&quot;</span><span class="p">)</span>
                <span class="n">test_filename</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span> <span class="n">test_basename</span><span class="p">)</span>
                <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cp </span><span class="si">{</span><span class="n">badcomp</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">test_filename</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Assemble the return value and return.</span>
    <span class="c1"># Bad comparisons are bits 0/1 of the return code.</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">badcomps</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">badcomps</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">badcomps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;BADCOMPS </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">badcomps</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">retval</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="write_remove_temp_files_to_file"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.write_remove_temp_files_to_file">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">write_remove_temp_files_to_file</span><span class="p">(</span><span class="n">remove_temp_files</span><span class="p">,</span> <span class="n">diffdir</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write text file with rm commands to remove temporary files.</span>

<span class="sd">    Write a text file ``rm_TEMPFILES.txt`` that can be sourced to remove</span>
<span class="sd">    temporary files that were created in the ``$GEOIPS_OUTDIRS`` scratch</span>
<span class="sd">    directory during the output comparison checks during integration tests.</span>
<span class="sd">    This currently includes temporary gunzipped versions of products</span>
<span class="sd">    (ie, if a product was gzipped during processing, then gunzipped to</span>
<span class="sd">    a temporary location during the comparison tests, it will get added</span>
<span class="sd">    to the `remove_temp_files` list), and may include additional temporary</span>
<span class="sd">    files in the future.</span>

<span class="sd">    The gunzipped files are not auto-deleted during the comparison process,</span>
<span class="sd">    because they must be manually copied to the tets outputs directory after</span>
<span class="sd">    processing is complete, so we do not remove the files at runtime.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    remove_temp_files: list</span>
<span class="sd">        List of files that should be written to ``rm_TEMPFILES.txt`` for deletion.</span>
<span class="sd">        This currently includes auto-gunzipped products, and potentially</span>
<span class="sd">        additional temporary files in the future.</span>
<span class="sd">    diffdir: str</span>
<span class="sd">        Full path to write ``rm_TEMPFILES.txt`` file</span>
<span class="sd">        NOTE: `diffdir` currently also is used to specify the path to the</span>
<span class="sd">        output files. Eventually we should pass in 2 separate paths, one</span>
<span class="sd">        to specify where to write the diff files, and a separate path</span>
<span class="sd">        indicating where to write the updated test output comparison files.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">        Binary code: 0 for successfully written ``rm_TEMPFILES.txt`` file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">remove_temp_files</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fname_rmtemp</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;rm_TEMPFILES.txt&quot;</span><span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span>
            <span class="s2">&quot;RMTEMPFILES Commands to remove </span><span class="si">%d</span><span class="s2"> &quot;</span>
            <span class="s2">&quot;temp files from gunzipped files scratch path.&quot;</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">remove_temp_files</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  source </span><span class="si">{</span><span class="n">fname_rmtemp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Include print statement for easy copy/paste at the command line</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;***</span><span class="se">\n</span><span class="s2">source </span><span class="si">{</span><span class="n">fname_rmtemp</span><span class="si">}</span><span class="se">\n</span><span class="s2">***&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname_rmtemp</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobj</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">remove_temp_file</span> <span class="ow">in</span> <span class="n">remove_temp_files</span><span class="p">:</span>
                <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rm -v </span><span class="si">{</span><span class="n">remove_temp_file</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="write_missing_products_to_file"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.write_missing_products_to_file">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">write_missing_products_to_file</span><span class="p">(</span><span class="n">missingproducts</span><span class="p">,</span> <span class="n">compare_products</span><span class="p">,</span> <span class="n">diffdir</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write text file with rm commands to remove products from comparison directory.</span>

<span class="sd">    Write a text file contatining rm commands that can be sourced to remove</span>
<span class="sd">    existing test output comparison files from the test comparison directories</span>
<span class="sd">    that were NOT found in the most recent output.</span>

<span class="sd">    When GeoIPS is updated in a way that intentionally causes a previously</span>
<span class="sd">    expected output to no longer be produced, it will cause the integration</span>
<span class="sd">    test comparison to fail with a MISSING PRODUCT error (ie, a file</span>
<span class="sd">    exists in the test comparison directory, but is not a current output</span>
<span class="sd">    product).</span>

<span class="sd">    When this is intended behaviour due to recent code updates, we must</span>
<span class="sd">    remove that product from the test output comparison directories.</span>

<span class="sd">    This function writes a file named `rm_MISSINGPRODUCTS.txt` which</span>
<span class="sd">    can be sourced to remove the files from the test comparison directory</span>
<span class="sd">    that were NOT found in the list of current output products. This</span>
<span class="sd">    allows easily updating the test comparison outputs when code updates</span>
<span class="sd">    make expected changes to the output products.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    missingproducts: list</span>
<span class="sd">        List of files that returned a &quot;MISSING PRODUCT&quot; from the output checker.</span>
<span class="sd">        These are the full paths to the files produced during the most recent</span>
<span class="sd">        run.</span>
<span class="sd">    compare_products: dict</span>
<span class="sd">        dictionary of comparison products - including the original comparison</span>
<span class="sd">        product file name, the gunzipped product file path if applicable,</span>
<span class="sd">        and the path to the file that should be used for comparison against</span>
<span class="sd">        &quot;missingproducts&quot; files.</span>
<span class="sd">    diffdir: str</span>
<span class="sd">        Full path to write &quot;rm_MISSINGPRODUCTS.txt&quot; file</span>
<span class="sd">        NOTE: diffdir currently also is used to specify the path to the</span>
<span class="sd">        output files. Eventually we should pass in 2 separate paths, one</span>
<span class="sd">        to specify where to write the diff files, and a separate path</span>
<span class="sd">        indicating where to write the updated test output comparison files.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">        Binary code: 0 if all comparisons were completed successfully, non-zero</span>
<span class="sd">        if there were missing products.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This should be in loop below</span>
    <span class="c1"># for compareproduct in compare_products:</span>
    <span class="c1">#     LOG.warning(</span>
    <span class="c1">#         &quot;MISSINGPRODUCT not in current run: %s&quot;,</span>
    <span class="c1">#         basename(compareproduct),</span>
    <span class="c1">#     )</span>
    <span class="c1"># If we have any missingproducts, loop through in order to write them to</span>
    <span class="c1"># file for manual removal from the test comparison directories.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missingproducts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Actual rm commands to remove files</span>
        <span class="n">fname_rm</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;rm_MISSINGPRODUCTS.txt&quot;</span><span class="p">)</span>
        <span class="c1"># cp commands to copy over the products for review to a temporary</span>
        <span class="c1"># directory.  This does not impact the actual test outputs.</span>
        <span class="n">fname_missingprodcptest</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;cptest_MISSINGPRODUCTS.txt&quot;</span><span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span>
            <span class="s2">&quot;MISSINGPRODUCTS Commands to remove </span><span class="si">%d</span><span class="s2"> &quot;</span>
            <span class="s2">&quot;incorrect files from test output path.&quot;</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">missingproducts</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;  source </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fname_missingprodcptest</span><span class="p">))</span>
        <span class="c1"># If there are missing products, ensure the source command to</span>
        <span class="c1"># remove them from the comparison test outputs directory is</span>
        <span class="c1"># printed at the interactive log level</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="s2">&quot;  source </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fname_rm</span><span class="p">))</span>
        <span class="c1"># Include print statement for easy copy/paste at the command line</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***</span><span class="se">\n</span><span class="s2">source </span><span class="si">{0}</span><span class="se">\n</span><span class="s2">***&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fname_rm</span><span class="p">))</span>
        <span class="n">test_path</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;MISSINGPRODUCTS&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname_rm</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobj</span><span class="p">:</span>
            <span class="c1"># Now loop through each missing product to write them to the file</span>
            <span class="k">for</span> <span class="n">missingproduct</span> <span class="ow">in</span> <span class="n">missingproducts</span><span class="p">:</span>
                <span class="n">missingproduct_basename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">missingproduct</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">compare_product</span> <span class="ow">in</span> <span class="n">compare_products</span><span class="p">:</span>
                    <span class="c1"># Pull the file that is actually used for comparison from</span>
                    <span class="c1"># the compare_products dictionary.</span>
                    <span class="n">file_for_comparison</span> <span class="o">=</span> <span class="n">compare_products</span><span class="p">[</span><span class="n">compare_product</span><span class="p">][</span>
                        <span class="s2">&quot;file_for_comparison&quot;</span>
                    <span class="p">]</span>
                    <span class="n">file_for_comparison_basename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">file_for_comparison</span><span class="p">)</span>
                    <span class="c1"># If the basename of the current missing product matches the</span>
                    <span class="c1"># basename of the file for comparison, then write out the</span>
                    <span class="c1"># command to remove the actual stored comparison file from</span>
                    <span class="c1"># the test repo.</span>
                    <span class="k">if</span> <span class="n">missingproduct_basename</span> <span class="o">==</span> <span class="n">file_for_comparison_basename</span><span class="p">:</span>
                        <span class="n">comparison_filename</span> <span class="o">=</span> <span class="n">compare_products</span><span class="p">[</span><span class="n">compare_product</span><span class="p">][</span>
                            <span class="s2">&quot;stored_comparison&quot;</span>
                        <span class="p">]</span>
                        <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  rm -v </span><span class="si">{</span><span class="n">comparison_filename</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    TEST OUTPUT: </span><span class="si">{</span><span class="n">comparison_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                            <span class="s2">&quot;MISSINGPRODUCT not in current run: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="n">basename</span><span class="p">(</span><span class="n">comparison_filename</span><span class="p">),</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">comparison_filename</span> <span class="o">=</span> <span class="n">compare_products</span><span class="p">[</span><span class="n">compare_product</span><span class="p">][</span>
                            <span class="s2">&quot;stored_comparison&quot;</span>
                        <span class="p">]</span>
                        <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  rm -v </span><span class="si">{</span><span class="n">comparison_filename</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    TEST OUTPUT: </span><span class="si">{</span><span class="n">file_for_comparison</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                            <span class="s2">&quot;MISSINGPRODUCT not in current run: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="n">basename</span><span class="p">(</span><span class="n">comparison_filename</span><span class="p">),</span>
                        <span class="p">)</span>
        <span class="c1"># This is just for testing purposes - write out copy commands to</span>
        <span class="c1"># copy the missing product into a test location for easy review.</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname_missingprodcptest</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobj</span><span class="p">:</span>
            <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mkdir </span><span class="si">{</span><span class="n">test_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">missingproduct</span> <span class="ow">in</span> <span class="n">missingproducts</span><span class="p">:</span>
                <span class="c1"># For display purposes - tifs are easier to view</span>
                <span class="n">test_basename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">missingproduct</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.jif&quot;</span><span class="p">,</span> <span class="s2">&quot;.tif&quot;</span><span class="p">)</span>
                <span class="n">test_filename</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span> <span class="n">test_basename</span><span class="p">)</span>
                <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cp -v </span><span class="si">{</span><span class="n">missingproduct</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">test_filename</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Assemble the return value and return.</span>
    <span class="c1"># Missing products are bits 4/5 of the return code.</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missingproducts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">missingproducts</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missingproducts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MISSINGPRODUCTS </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">missingproducts</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">retval</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span></div>


<div class="viewcode-block" id="write_missing_comparisons_to_file"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.write_missing_comparisons_to_file">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">write_missing_comparisons_to_file</span><span class="p">(</span><span class="n">missingcomps</span><span class="p">,</span> <span class="n">diffdir</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write text file with cp commands to add products to comparison directory.</span>

<span class="sd">    Write a text file contatining cp commands that can be sourced to add</span>
<span class="sd">    new test output comparison files to the test comparison directories</span>
<span class="sd">    that were found in the most recent output and were not previously in</span>
<span class="sd">    the test comparison directory.</span>

<span class="sd">    When GeoIPS is updated in a way that intentionally causes a new</span>
<span class="sd">    output product, it will cause the integration test comparison to fail</span>
<span class="sd">    with a MISSING COMPARE error (ie, a file exists in the current output</span>
<span class="sd">    product path, but does not exist in the test comparison directory).</span>

<span class="sd">    When this is intended behaviour due to recent code updates, we must</span>
<span class="sd">    add that new product to the test output comparison directories from</span>
<span class="sd">    the current output path.</span>

<span class="sd">    This function writes a file named `cp_MISSINGCOMPARE.txt` which</span>
<span class="sd">    can be sourced to copy the appropriate files from the current</span>
<span class="sd">    output product path into the test comparison directory. This</span>
<span class="sd">    allows easily updating the test comparison outputs when code updates</span>
<span class="sd">    make expected changes to the output products.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    missingcomps: list</span>
<span class="sd">        List of files that returned a &quot;MISSING COMPARE&quot; from the output checker.</span>
<span class="sd">        These are the full paths to the files produced during the most recent</span>
<span class="sd">        run.</span>
<span class="sd">    diffdir: str</span>
<span class="sd">        Full path to write &quot;rm_MISSINGCOMPARE.txt&quot; file</span>
<span class="sd">        NOTE: diffdir currently also is used to specify the path to the</span>
<span class="sd">        output files. Eventually we should pass in 2 separate paths, one</span>
<span class="sd">        to specify where to write the diff files, and a separate path</span>
<span class="sd">        indicating where to write the updated test output comparison files.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">        Binary code: 0 if all comparisons were completed successfully, non-zero</span>
<span class="sd">        if there were missing comparisons.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">missingcompare</span> <span class="ow">in</span> <span class="n">missingcomps</span><span class="p">:</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;MISSINGCOMPARE not in comparepath: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">basename</span><span class="p">(</span><span class="n">missingcompare</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missingcomps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fname_cp</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;cp_MISSINGCOMPARE.txt&quot;</span><span class="p">)</span>
        <span class="n">fname_missingcompcptest</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;cptest_MISSINGCOMPARE.txt&quot;</span><span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span>
            <span class="s2">&quot;MISSINGCOMPARE Commands to copy </span><span class="si">%d</span><span class="s2"> missing files to comparison path.&quot;</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">missingcomps</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;  source </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fname_missingcompcptest</span><span class="p">))</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="s2">&quot;  source </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fname_cp</span><span class="p">))</span>
        <span class="c1"># Include print statement for easy copy/paste at the command line</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***</span><span class="se">\n</span><span class="s2">source </span><span class="si">{0}</span><span class="se">\n</span><span class="s2">***&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fname_cp</span><span class="p">))</span>
        <span class="n">comparison_path</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
        <span class="n">test_path</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;MISSINGCOMPARE&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname_cp</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobj</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">missingcomp</span> <span class="ow">in</span> <span class="n">missingcomps</span><span class="p">:</span>
                <span class="c1"># We are passing the missingcomp directly to the diff dir</span>
                <span class="c1"># We have no knowledge if these should be gzipped or not,</span>
                <span class="c1"># so they are just copied as is.  Developers must manually</span>
                <span class="c1"># gzip before commiting if desired.</span>
                <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  cp -v </span><span class="si">{</span><span class="n">missingcomp</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">comparison_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    CURR OUTPUT: </span><span class="si">{</span><span class="n">missingcomp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname_missingcompcptest</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobj</span><span class="p">:</span>
            <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mkdir </span><span class="si">{</span><span class="n">test_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">missingcomp</span> <span class="ow">in</span> <span class="n">missingcomps</span><span class="p">:</span>
                <span class="c1"># For display purposes - tifs are easier to view</span>
                <span class="n">test_basename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">missingcomp</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.jif&quot;</span><span class="p">,</span> <span class="s2">&quot;.tif&quot;</span><span class="p">)</span>
                <span class="n">test_filename</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span> <span class="n">test_basename</span><span class="p">)</span>
                <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cp -v </span><span class="si">{</span><span class="n">missingcomp</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">test_filename</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Assemble the return value and return.</span>
    <span class="c1"># Missing comparisons are bits 2/3 of the return code.</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missingcomps</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">missingcomps</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missingcomps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MISSINGCOMPS </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">missingcomps</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">retval</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="write_good_comparisons_to_file"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.write_good_comparisons_to_file">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">write_good_comparisons_to_file</span><span class="p">(</span><span class="n">goodcomps</span><span class="p">,</span> <span class="n">compare_strings</span><span class="p">,</span> <span class="n">diffdir</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write all good comparisons to a file for easy collection of outputs.</span>

<span class="sd">    During integration tests, if the current product output matches the</span>
<span class="sd">    test output stored in the test comparison directories, the output</span>
<span class="sd">    checkers will return 0 as a GOOD COMPARE.  These outputs do not need</span>
<span class="sd">    to be updated in the test comparison directories, since the current</span>
<span class="sd">    products and test comparison outputs match within tolerance.</span>

<span class="sd">    The developer may desire copying these files to a single location</span>
<span class="sd">    convenience, however.</span>

<span class="sd">    This function writes a file named `cptest_GOODCOMPARE.txt` which</span>
<span class="sd">    can be sourced to copy all products that were identical to the</span>
<span class="sd">    current output products to a common location, for convenience.</span>
<span class="sd">    This does not impact any files stored in the test comparison</span>
<span class="sd">    directories.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    goodcomps: list</span>
<span class="sd">        List of files that returned a &quot;GOOD COMPARE&quot; from the output checker.</span>
<span class="sd">        These are the full paths to the files produced during the most recent</span>
<span class="sd">        run.</span>
<span class="sd">    compare_strings : list of str</span>
<span class="sd">        List of all comparison &quot;tags&quot; included in goodcomps and badcomps lists.</span>

<span class="sd">        * This list is used to remove the comparison tags from goodcomps and</span>
<span class="sd">          badcomps to retrieve only the file path when writing the cp commands.</span>
<span class="sd">    diffdir: str</span>
<span class="sd">        Full path to write &quot;cptest_GOODCOMPARE.txt&quot; file</span>
<span class="sd">        NOTE: diffdir currently also is used to specify the path to the</span>
<span class="sd">        output files. Eventually we should pass in 2 separate paths, one</span>
<span class="sd">        to specify where to write the diff files, and a separate path</span>
<span class="sd">        indicating where to write the updated test output comparison files.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">        Binary code: 0 for good comparisons</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">goodcompare</span> <span class="ow">in</span> <span class="n">goodcomps</span><span class="p">:</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;GOODCOMPARE </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">goodcompare</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goodcomps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fname_goodcptest</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;cptest_GOODCOMPARE.txt&quot;</span><span class="p">)</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source </span><span class="si">{</span><span class="n">fname_goodcptest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">test_path</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;GOODCOMPARE&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname_goodcptest</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobj</span><span class="p">:</span>
            <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mkdir </span><span class="si">{</span><span class="n">test_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">goodcomp</span> <span class="ow">in</span> <span class="n">goodcomps</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">compare_strings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">compare_string</span> <span class="ow">in</span> <span class="n">compare_strings</span><span class="p">:</span>
                        <span class="n">goodcomp</span> <span class="o">=</span> <span class="n">goodcomp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">compare_string</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1"># For display purposes - tifs are easier to view</span>
                <span class="n">test_basename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">goodcomp</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.jif&quot;</span><span class="p">,</span> <span class="s2">&quot;.tif&quot;</span><span class="p">)</span>
                <span class="n">test_filename</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span> <span class="n">test_basename</span><span class="p">)</span>
                <span class="n">fobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cp </span><span class="si">{</span><span class="n">goodcomp</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">test_filename</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="get_missing_products"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.get_missing_products">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">get_missing_products</span><span class="p">(</span><span class="n">output_products_for_comparison</span><span class="p">,</span> <span class="n">compare_products</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get list of missing products from compare_products_dictionary.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    output_products_for_comparison: list</span>
<span class="sd">        List of output products from the current run.</span>
<span class="sd">    compare_products: dict</span>
<span class="sd">        Dictionary of products found in the test comparison directory.</span>
<span class="sd">        Note the key of the compare_products dictionary is the filename that</span>
<span class="sd">        is stored in the comparison directory (ie, this may be a gzipped file).</span>
<span class="sd">        We must use the &quot;gunzipped_comparison&quot;, &quot;stored_comparison&quot;, and</span>
<span class="sd">        &quot;file_for_comparison&quot; keys within that dictionary to ensure we are</span>
<span class="sd">        accessing the correct versions of the files.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    missingproducts : list</span>
<span class="sd">        List of products that were missing from the current run.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">missingproducts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">output_product_for_comparison</span> <span class="ow">in</span> <span class="n">output_products_for_comparison</span><span class="p">:</span>
        <span class="n">found_one</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># compare_products is a dictionary,</span>
        <span class="c1"># with &quot;basename(compare_product)&quot; as the keys.</span>
        <span class="c1"># Add the full paths to the missing files as the missingproducts.</span>
        <span class="k">for</span> <span class="n">basename_compare_product</span> <span class="ow">in</span> <span class="n">compare_products</span><span class="p">:</span>
            <span class="c1"># We want to check that file_for_comparison is in the list of</span>
            <span class="c1"># output_products_for_comparison.  We know file_for_comparison will always</span>
            <span class="c1"># be the file corresponding to the actual current output products.</span>
            <span class="c1"># gunzipped_comparisons may be None, and stored_comparisons may be</span>
            <span class="c1"># gzipped.</span>
            <span class="n">file_for_comparison</span> <span class="o">=</span> <span class="n">compare_products</span><span class="p">[</span><span class="n">basename_compare_product</span><span class="p">][</span>
                <span class="s2">&quot;file_for_comparison&quot;</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">basename</span><span class="p">(</span><span class="n">file_for_comparison</span><span class="p">)</span> <span class="o">==</span> <span class="n">basename</span><span class="p">(</span><span class="n">output_product_for_comparison</span><span class="p">):</span>
                <span class="n">found_one</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">found_one</span><span class="p">:</span>
            <span class="n">missingproducts</span> <span class="o">+=</span> <span class="p">[</span><span class="n">output_product_for_comparison</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">missingproducts</span></div>


<div class="viewcode-block" id="is_gz"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.is_gz">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">is_gz</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if fname is a gzip file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fname : str</span>
<span class="sd">        Name of file to check.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if it is a gz file, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">splitext</span><span class="p">(</span><span class="n">fname</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.gz&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="c1"># If a file exists with the base fname appended with .gz,</span>
    <span class="c1"># then use that.</span>
    <span class="k">if</span> <span class="n">glob</span><span class="p">(</span><span class="n">fname</span> <span class="o">+</span> <span class="s2">&quot;.gz&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="gunzip_product"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.gunzip_product">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">gunzip_product</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">is_comparison_product</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clobber</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gunzip file fname.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fname : str</span>
<span class="sd">        File to gunzip.</span>
<span class="sd">    is_comparison_product : bool, default False</span>
<span class="sd">        * If True, set to $GEOIPS_OUTDIRS/gunzipped_products/comparison_products</span>
<span class="sd">        * If False, set to $GEOIPS_OUTDIRS/gunzipped_products/output_products</span>
<span class="sd">    clobber : bool, default False</span>
<span class="sd">        If True, overwrite existing file, else do nothing.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Filename after gunzipping</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If it is already a .gz file, use that.</span>
    <span class="k">if</span> <span class="n">splitext</span><span class="p">(</span><span class="n">fname</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.gz&quot;</span><span class="p">]:</span>
        <span class="n">gz_fname</span> <span class="o">=</span> <span class="n">fname</span>
    <span class="c1"># Otherwise, see if the .gz version exists.</span>
    <span class="k">elif</span> <span class="n">glob</span><span class="p">(</span><span class="n">fname</span> <span class="o">+</span> <span class="s2">&quot;.gz&quot;</span><span class="p">):</span>
        <span class="n">gz_fname</span> <span class="o">=</span> <span class="n">fname</span> <span class="o">+</span> <span class="s2">&quot;.gz&quot;</span>

    <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Gunzipping product for comparisons&quot;</span><span class="p">]</span>
    <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;gunzip </span><span class="si">{</span><span class="n">gz_fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">log_with_emphasis</span><span class="p">(</span><span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="o">*</span><span class="n">messages</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">is_comparison_product</span><span class="p">:</span>
        <span class="n">save_dir</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span>
            <span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GEOIPS_OUTDIRS&quot;</span><span class="p">),</span>
            <span class="s2">&quot;scratch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gunzipped_products&quot;</span><span class="p">,</span>
            <span class="s2">&quot;comparison_products&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">save_dir</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span>
            <span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GEOIPS_OUTDIRS&quot;</span><span class="p">),</span> <span class="s2">&quot;scratch&quot;</span><span class="p">,</span> <span class="s2">&quot;gunzipped_products&quot;</span><span class="p">,</span> <span class="s2">&quot;output_products&quot;</span>
        <span class="p">)</span>
    <span class="n">make_dirs</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span>
    <span class="n">gunzip_basename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">basename</span><span class="p">(</span><span class="n">gz_fname</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gz&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">gunzip_filename</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">gunzip_basename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">clobber</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">gunzip_filename</span><span class="p">):</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="s2">&quot;Gunzipping file </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">gz_fname</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">)</span>
        <span class="c1"># Read in the compressed data</span>
        <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">gz_fname</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_in</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">gunzip_filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_out</span><span class="p">:</span>
                <span class="n">copyfileobj</span><span class="p">(</span><span class="n">f_in</span><span class="p">,</span> <span class="n">f_out</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gunzip_filename</span></div>


<div class="viewcode-block" id="OutputCheckersBasePlugin"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersBasePlugin">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">OutputCheckersBasePlugin</span><span class="p">(</span><span class="n">BaseModulePlugin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Output Checkers Base Plugin for comparing data outputs.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="OutputCheckersBasePlugin.is_gz"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersBasePlugin.is_gz">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_gz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if fname is a gzip file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fname : str</span>
<span class="sd">            Name of file to check.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if it is a gz file, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">is_gz</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>

<div class="viewcode-block" id="OutputCheckersBasePlugin.gunzip_product"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersBasePlugin.gunzip_product">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">gunzip_product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">is_comparison_product</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clobber</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gunzip file fname.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fname : str</span>
<span class="sd">            File to gunzip.</span>
<span class="sd">        is_comparison_product : bool, default False</span>
<span class="sd">            * If True, set to $GEOIPS_OUTDIRS/gunzipped_products/comparison_products</span>
<span class="sd">            * If False, set to $GEOIPS_OUTDIRS/gunzipped_products/output_products</span>
<span class="sd">        clobber : bool, default False</span>
<span class="sd">            If True, overwrite existing file, else do nothing.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Filename after gunzipping</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">gunzip_product</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">is_comparison_product</span><span class="p">,</span> <span class="n">clobber</span><span class="p">)</span></div>

<div class="viewcode-block" id="OutputCheckersBasePlugin.get_out_diff_fname"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersBasePlugin.get_out_diff_fname">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_out_diff_fname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compare_product</span><span class="p">,</span> <span class="n">output_product</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Obtain the filename for output and comparison product diff.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        compare_product : str</span>
<span class="sd">            Full path to product filename in the comparison directory</span>
<span class="sd">        output_product : str</span>
<span class="sd">            Full path to product filename in the current output directory</span>
<span class="sd">        ext : str, default=None</span>
<span class="sd">            Extension to use as an alternative to the original file extension</span>
<span class="sd">        flag : str, default=None</span>
<span class="sd">            Additional identifying string to include in output diff filename</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_diff_fname : str</span>
<span class="sd">            Full path to output diff file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">diffdir</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span>
            <span class="n">dirname</span><span class="p">(</span><span class="n">compare_product</span><span class="p">),</span> <span class="s2">&quot;diff_test_output_dir_</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;USER&quot;</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">out_diff_fname</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span>
            <span class="n">diffdir</span><span class="p">,</span> <span class="s2">&quot;diff_test_output_&quot;</span> <span class="o">+</span> <span class="n">flag</span> <span class="o">+</span> <span class="n">basename</span><span class="p">(</span><span class="n">output_product</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">diffdir</span><span class="p">):</span>
            <span class="n">makedirs</span><span class="p">(</span><span class="n">diffdir</span><span class="p">)</span>
        <span class="c1"># Allow outputing a different extension than the original.</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">out_diff_fname</span> <span class="o">=</span> <span class="n">splitext</span><span class="p">(</span><span class="n">out_diff_fname</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ext</span>
        <span class="c1"># Create a png diff image for simplicity</span>
        <span class="k">elif</span> <span class="n">splitext</span><span class="p">(</span><span class="n">out_diff_fname</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;.jif&quot;</span><span class="p">:</span>
            <span class="n">out_diff_fname</span> <span class="o">=</span> <span class="n">splitext</span><span class="p">(</span><span class="n">out_diff_fname</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span>
        <span class="k">return</span> <span class="n">out_diff_fname</span></div>

<div class="viewcode-block" id="OutputCheckersBasePlugin.get_compare_products"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersBasePlugin.get_compare_products">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_compare_products</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compare_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get dictionary of compare products from the compare_path.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        compare_path: str</span>
<span class="sd">            Full path to the comparison directory to populate compare_products</span>
<span class="sd">            dictionary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        compare_products: dict</span>
<span class="sd">            Dictionary of products found in the test comparison directory.</span>
<span class="sd">            The key of the compare_products dictionary is the filename that</span>
<span class="sd">            is stored in the comparison directory (ie, this may be a gzipped file).</span>

<span class="sd">            * stored_comparison is the actual name stored in the comparison test dir</span>
<span class="sd">            * gunzipped comparison is the gunzipped version of the file, or None if</span>
<span class="sd">              file was not gzipped</span>
<span class="sd">            * file_for_comparison is &quot;compare_product&quot; if the file is not gzipped,</span>
<span class="sd">              and &quot;gunzipped_comparison&quot; if file is gzipped.</span>
<span class="sd">        remove_temp_files: list</span>
<span class="sd">            List of full paths to files that must be removed after processing</span>
<span class="sd">            (gunzipped files in GEOIPS_OUTDIRS scratch directory)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Here we are collecting the basenames of the files for comparison, as</span>
        <span class="c1"># well as the associated gz filename if the original comparison product</span>
        <span class="c1"># was gzipped.</span>
        <span class="n">compare_products</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">remove_temp_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop through all comparison products found in &quot;compare_path&quot;. We want</span>
        <span class="c1"># to collect ALL products available for comparison.</span>
        <span class="k">for</span> <span class="n">compare_product</span> <span class="ow">in</span> <span class="n">glob</span><span class="p">(</span><span class="n">compare_path</span> <span class="o">+</span> <span class="s2">&quot;/*&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">isdir</span><span class="p">(</span><span class="n">compare_product</span><span class="p">):</span>
                <span class="c1"># Skip &#39;diff&#39; output directory</span>
                <span class="k">continue</span>
            <span class="n">file_for_comparison</span> <span class="o">=</span> <span class="n">compare_product</span>
            <span class="n">compare_product_gunzipped</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># If the current product is gzipped, we want to gunzip it for comparison.</span>
            <span class="c1"># We always gunzip for comparison.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_gz</span><span class="p">(</span><span class="n">compare_product</span><span class="p">):</span>
                <span class="c1"># self.gunzip_product returns the resulting filename (which may be</span>
                <span class="c1"># in a different directory). NOTE: this is the first time gunzip</span>
                <span class="c1"># is run on compare_products, so ensure we clobber what is there.</span>
                <span class="n">compare_product_gunzipped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gunzip_product</span><span class="p">(</span>
                    <span class="n">compare_product</span><span class="p">,</span> <span class="n">is_comparison_product</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clobber</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="n">remove_temp_files</span> <span class="o">+=</span> <span class="p">[</span><span class="n">compare_product_gunzipped</span><span class="p">]</span>
                <span class="n">file_for_comparison</span> <span class="o">=</span> <span class="n">compare_product_gunzipped</span>
            <span class="c1"># This is a complete list of all comparison products.</span>
            <span class="c1"># stored_comparison is the actual name stored in the comparison test dir</span>
            <span class="c1"># gunzipped comparison is the gunzipped version of the file, or None if</span>
            <span class="c1">#   file was not gzipped</span>
            <span class="c1"># file_for_comparison is &quot;compare_product&quot; if the file is not gzipped,</span>
            <span class="c1">#   and &quot;gunzipped_comparison&quot; if file is gzipped.</span>
            <span class="n">compare_products</span><span class="p">[</span><span class="n">basename</span><span class="p">(</span><span class="n">compare_product</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;stored_comparison&quot;</span><span class="p">:</span> <span class="n">compare_product</span><span class="p">,</span>
                <span class="s2">&quot;gunzipped_comparison&quot;</span><span class="p">:</span> <span class="n">compare_product_gunzipped</span><span class="p">,</span>
                <span class="s2">&quot;file_for_comparison&quot;</span><span class="p">:</span> <span class="n">file_for_comparison</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="k">return</span> <span class="n">compare_products</span><span class="p">,</span> <span class="n">remove_temp_files</span></div>

<div class="viewcode-block" id="OutputCheckersBasePlugin.perform_comparisons"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersBasePlugin.perform_comparisons">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">perform_comparisons</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">output_products</span><span class="p">,</span>
        <span class="n">compare_products</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the final output products list from the original list of outputs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        output_products : list</span>
<span class="sd">            This is the original list of output products, exactly as they are</span>
<span class="sd">            produced during processing.  If a product is gzipped during processing,</span>
<span class="sd">            the output_products list will include the gzipped file.</span>
<span class="sd">        compare_products : dict</span>
<span class="sd">            This is a dictionary containing all of the comparison products available</span>
<span class="sd">            in the test outputs directory.</span>

<span class="sd">            * Keys: basename of actual output product as created during run</span>
<span class="sd">              (ie, gzipped if applicable)</span>

<span class="sd">              * key: &quot;file_for_comparison&quot;, value: full path to file that is used</span>
<span class="sd">                when comparing against the current output (ie, could be temporary</span>
<span class="sd">                gunzip location).</span>
<span class="sd">              * key: &quot;gunzipped_comparison&quot;, value: None if original output file was</span>
<span class="sd">                not gzipped, full path to gunzipped file if original output file</span>
<span class="sd">                was gzipped.</span>
<span class="sd">              * key: &quot;stored_comparison&quot;, value: full path to file that is stored in</span>
<span class="sd">                the tests outputs location (ie, could be gzipped)</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            keyword arguments to pass directly through to test products function.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output_products_for_comparison : list</span>
<span class="sd">            List of full paths to files that will be used for comparisons.  Ie,</span>
<span class="sd">            if the output product was gzipped, this would be the full path to</span>
<span class="sd">            the gunzipped file in the temporary location.</span>
<span class="sd">        missingcomps : list</span>
<span class="sd">            List of full paths to files that were found in the current run, and NOT</span>
<span class="sd">            found in the comparison directory.</span>
<span class="sd">        goodcomps : list</span>
<span class="sd">            List of full paths to files that had good comparisons.</span>
<span class="sd">        badcomps : list</span>
<span class="sd">            List of full paths to files that had bad comparisons between the</span>
<span class="sd">            current output products and the test comparison outputs.</span>
<span class="sd">        compare_strings : list</span>
<span class="sd">            List of strings included in log output for each type of comparison.</span>
<span class="sd">        remove_temp_files : list</span>
<span class="sd">            List of full paths to files that should be removed from temporary scratch</span>
<span class="sd">            directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output_products_for_comparison</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">remove_temp_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">missingcomps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">goodcomps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">badcomps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">compare_strings</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">output_product</span> <span class="ow">in</span> <span class="n">output_products</span><span class="p">:</span>
            <span class="c1"># Skip &#39;diff&#39; output directory</span>
            <span class="k">if</span> <span class="n">isdir</span><span class="p">(</span><span class="n">output_product</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="n">output_product_for_comparison</span> <span class="o">=</span> <span class="n">output_product</span>
            <span class="c1"># Gunzip the output product if it is a gzipped file.</span>
            <span class="c1"># We will perform all comparisons on the gunzipped form.</span>
            <span class="k">if</span> <span class="n">is_gz</span><span class="p">(</span><span class="n">output_product</span><span class="p">):</span>
                <span class="n">output_product_for_comparison</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gunzip_product</span><span class="p">(</span>
                    <span class="n">output_product</span><span class="p">,</span> <span class="n">is_comparison_product</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
                <span class="n">remove_temp_files</span> <span class="o">+=</span> <span class="p">[</span><span class="n">output_product_for_comparison</span><span class="p">]</span>

            <span class="n">log_with_emphasis</span><span class="p">(</span><span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;COMPARE </span><span class="si">{</span><span class="n">output_product_for_comparison</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">found_one</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">compare_product</span> <span class="ow">in</span> <span class="n">compare_products</span><span class="p">:</span>
                <span class="n">file_for_comparison</span> <span class="o">=</span> <span class="n">compare_products</span><span class="p">[</span><span class="n">basename</span><span class="p">(</span><span class="n">compare_product</span><span class="p">)][</span>
                    <span class="s2">&quot;file_for_comparison&quot;</span>
                <span class="p">]</span>
                <span class="c1"># If the current output product matches the basename of the</span>
                <span class="c1"># gunzipped comparison product, then we have a match and</span>
                <span class="c1"># we can actually compare the files.  Whether a file is</span>
                <span class="c1"># gzipped in the current output directory, or the comparison</span>
                <span class="c1"># directory, we ALWAYS compare the gunzipped version, so this</span>
                <span class="c1"># comparison will always hold (output_product will always be</span>
                <span class="c1"># gunzipped, as well gunzipped_comparison).</span>
                <span class="k">if</span> <span class="n">basename</span><span class="p">(</span><span class="n">output_product_for_comparison</span><span class="p">)</span> <span class="o">==</span> <span class="n">basename</span><span class="p">(</span>
                    <span class="n">file_for_comparison</span>
                <span class="p">):</span>
                    <span class="n">found_one</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">test_product_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_products</span>
                    <span class="n">goodcomps</span><span class="p">,</span> <span class="n">badcomps</span><span class="p">,</span> <span class="n">compare_strings</span> <span class="o">=</span> <span class="n">test_product_func</span><span class="p">(</span>
                        <span class="n">output_product_for_comparison</span><span class="p">,</span>
                        <span class="n">file_for_comparison</span><span class="p">,</span>
                        <span class="n">goodcomps</span><span class="p">,</span>
                        <span class="n">badcomps</span><span class="p">,</span>
                        <span class="n">compare_strings</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="c1"># If we didn&#39;t find an exact filename match, then we have a missing</span>
            <span class="c1"># comparison, so append to the missingcomps list.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">found_one</span><span class="p">:</span>
                <span class="n">missingcomps</span> <span class="o">+=</span> <span class="p">[</span><span class="n">output_product_for_comparison</span><span class="p">]</span>
            <span class="n">output_products_for_comparison</span> <span class="o">+=</span> <span class="p">[</span><span class="n">output_product_for_comparison</span><span class="p">]</span>

            <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">output_products_for_comparison</span><span class="p">,</span>
            <span class="n">missingcomps</span><span class="p">,</span>
            <span class="n">goodcomps</span><span class="p">,</span>
            <span class="n">badcomps</span><span class="p">,</span>
            <span class="n">compare_strings</span><span class="p">,</span>
            <span class="n">remove_temp_files</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="OutputCheckersBasePlugin.compare_outputs"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersBasePlugin.compare_outputs">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">compare_outputs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">compare_path</span><span class="p">,</span>
        <span class="n">output_products</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare the &quot;correct&quot; imagery found the list of current output_products.</span>

<span class="sd">        Compares files produced in the current processing run with the list of</span>
<span class="sd">        &quot;correct&quot; files contained in &quot;compare_path&quot;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        compare_path : str</span>
<span class="sd">            Path to directory of &quot;correct&quot; products - filenames must match</span>
<span class="sd">            output_products</span>
<span class="sd">        output_products : list of str</span>
<span class="sd">            List of strings of current output products,</span>
<span class="sd">            to compare with products in compare_path</span>
<span class="sd">        kwargs: dict</span>
<span class="sd">            Dictionary containing kwargs for comparing products.</span>
<span class="sd">            This gets passed through to the &quot;test_products&quot; method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Binary code: 0 if all comparisons were completed successfully.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">log_with_emphasis</span><span class="p">(</span><span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;COMPARISONS OF KNOWN OUTPUTS IN </span><span class="si">{</span><span class="n">compare_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># We gunzip comparison files to a temporary location, so keep track of</span>
        <span class="c1"># all the temporary files so we can remove them at the end.</span>
        <span class="n">remove_temp_files</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">compare_products</span><span class="p">,</span> <span class="n">curr_remove_temp_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_compare_products</span><span class="p">(</span>
            <span class="n">compare_path</span>
        <span class="p">)</span>
        <span class="n">remove_temp_files</span> <span class="o">+=</span> <span class="n">curr_remove_temp_files</span>

        <span class="c1"># This returns the list of output products that will be used for</span>
        <span class="c1"># comparisons (ie, the gunzipped version if the original was gzipped),</span>
        <span class="c1"># the list of missing comparison products, and appends to the list</span>
        <span class="c1"># of temp files to remove.</span>
        <span class="p">(</span>
            <span class="n">output_products_for_comparison</span><span class="p">,</span>
            <span class="n">missingcomps</span><span class="p">,</span>
            <span class="n">goodcomps</span><span class="p">,</span>
            <span class="n">badcomps</span><span class="p">,</span>
            <span class="n">compare_strings</span><span class="p">,</span>
            <span class="n">curr_remove_temp_files</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_comparisons</span><span class="p">(</span>
            <span class="n">output_products</span><span class="p">,</span>
            <span class="n">compare_products</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">remove_temp_files</span> <span class="o">+=</span> <span class="n">curr_remove_temp_files</span>
        <span class="n">log_with_emphasis</span><span class="p">(</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;DONE RUNNING COMPARISONS OF KNOWN OUTPUTS IN </span><span class="si">{</span><span class="n">compare_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Identify all missing products based on the list of output products</span>
        <span class="c1"># and the dictionary of comparison products</span>
        <span class="n">missingproducts</span> <span class="o">=</span> <span class="n">get_missing_products</span><span class="p">(</span>
            <span class="n">output_products_for_comparison</span><span class="p">,</span> <span class="n">compare_products</span>
        <span class="p">)</span>

        <span class="n">diffdir</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">compare_path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;diff_test_output_dir_</span><span class="si">{</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;USER&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">diffdir</span><span class="p">):</span>
            <span class="n">makedirs</span><span class="p">(</span><span class="n">diffdir</span><span class="p">)</span>

        <span class="n">retval</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">retval</span> <span class="o">+=</span> <span class="n">write_good_comparisons_to_file</span><span class="p">(</span><span class="n">goodcomps</span><span class="p">,</span> <span class="n">compare_strings</span><span class="p">,</span> <span class="n">diffdir</span><span class="p">)</span>
        <span class="n">retval</span> <span class="o">+=</span> <span class="n">write_missing_comparisons_to_file</span><span class="p">(</span><span class="n">missingcomps</span><span class="p">,</span> <span class="n">diffdir</span><span class="p">)</span>
        <span class="n">retval</span> <span class="o">+=</span> <span class="n">write_missing_products_to_file</span><span class="p">(</span>
            <span class="n">missingproducts</span><span class="p">,</span> <span class="n">compare_products</span><span class="p">,</span> <span class="n">diffdir</span>
        <span class="p">)</span>
        <span class="n">retval</span> <span class="o">+=</span> <span class="n">write_remove_temp_files_to_file</span><span class="p">(</span><span class="n">remove_temp_files</span><span class="p">,</span> <span class="n">diffdir</span><span class="p">)</span>
        <span class="n">retval</span> <span class="o">+=</span> <span class="n">write_bad_comparisons_to_file</span><span class="p">(</span>
            <span class="n">badcomps</span><span class="p">,</span> <span class="n">compare_products</span><span class="p">,</span> <span class="n">compare_strings</span><span class="p">,</span> <span class="n">diffdir</span>
        <span class="p">)</span>

        <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;retval: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">bin</span><span class="p">(</span><span class="n">retval</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">retval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Nonzero return value indicates error, 6 bit binary code: &quot;</span> <span class="s2">&quot;WXY where:&quot;</span>
            <span class="p">)</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="s2">&quot;    Y (0-1): BADCOMP: number of bad comparisons found between&quot;</span>
                    <span class="s2">&quot;comparepath and current run output path&quot;</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="s2">&quot;    X (2-3): MISSINGCOMP: Number of products missing in &quot;</span>
                    <span class="s2">&quot;compare path but existing in current output path&quot;</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="s2">&quot;    W (4-5): MISSINGPROD: Number of products existing in &quot;</span>
                    <span class="s2">&quot;comparepath, but missing in current output path&quot;</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="OutputCheckersBasePlugin.test_products"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersBasePlugin.test_products">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_products</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">output_product</span><span class="p">,</span>
        <span class="n">compare_product</span><span class="p">,</span>
        <span class="n">goodcomps</span><span class="p">,</span>
        <span class="n">badcomps</span><span class="p">,</span>
        <span class="n">compare_strings</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test output_product against &quot;good&quot; product stored in &quot;compare_path&quot;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        output_product : str</span>
<span class="sd">            * Full path to current output product</span>
<span class="sd">        compare_product : str</span>
<span class="sd">            * Full path to &quot;good&quot; comparison product</span>
<span class="sd">        goodcomps : list of str</span>
<span class="sd">            * List of full paths to all &quot;good&quot; successful comparisons</span>
<span class="sd">              (output and compare images match)</span>
<span class="sd">            * Each str is prepended with a &quot;compare_string&quot; tag to identify which</span>
<span class="sd">              comparison type was performed.</span>
<span class="sd">        badcomps : list of str</span>
<span class="sd">            * List of full paths to all &quot;bad&quot; unsuccessful comparisons</span>
<span class="sd">              (output and compare images differ)</span>
<span class="sd">            * Each str is prepended with a &quot;compare_string&quot; tag to identify which</span>
<span class="sd">              comparison type was performed.</span>
<span class="sd">        compare_strings : list of str</span>
<span class="sd">            * List of all comparison &quot;tags&quot; included in goodcomps and badcomps lists.</span>
<span class="sd">            * This list is used to remove the comparison tags from goodcomps and</span>
<span class="sd">              badcomps to retrieve only the file path.</span>
<span class="sd">        kwargs: dict</span>
<span class="sd">            Additional arguments to pass through to &quot;outputs_match&quot; method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        goodcomps: list of str</span>
<span class="sd">            All current good comparisons appended to the list passed in.</span>
<span class="sd">        badcomps: list of str</span>
<span class="sd">            All current bad comparisons appended to the list passed in.</span>
<span class="sd">        compare_strings: list of str</span>
<span class="sd">            All current comparison &quot;tags&quot; added to the list passed in.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            Raised when current output product does not have an associated</span>
<span class="sd">            comparison test defined.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_gz</span><span class="p">(</span><span class="n">compare_product</span><span class="p">):</span>
            <span class="n">compare_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gunzip_product</span><span class="p">(</span>
                <span class="n">compare_product</span><span class="p">,</span> <span class="n">is_comparison_product</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;netcdf&quot;</span><span class="p">:</span>
            <span class="n">comp_str</span> <span class="o">=</span> <span class="s2">&quot;GEOIPS NETCDF &quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comp_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
        <span class="n">compare_strings</span> <span class="o">+=</span> <span class="p">[</span><span class="n">comp_str</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">outputs_match</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">output_product</span><span class="p">,</span>
            <span class="n">compare_product</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="n">goodcomps</span> <span class="o">+=</span> <span class="p">[</span><span class="n">comp_str</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_product</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">badcomps</span> <span class="o">+=</span> <span class="p">[</span><span class="n">comp_str</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_product</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">goodcomps</span><span class="p">,</span> <span class="n">badcomps</span><span class="p">,</span> <span class="n">compare_strings</span></div></div>


<div class="viewcode-block" id="OutputCheckersInterface"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersInterface">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">OutputCheckersInterface</span><span class="p">(</span><span class="n">BaseModuleInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Output Checkers routines to apply when comparing data outputs.&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;output_checkers&quot;</span>
    <span class="n">required_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;standard&quot;</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="n">required_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;standard&quot;</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="n">plugin_class</span> <span class="o">=</span> <span class="n">OutputCheckersBasePlugin</span>
    <span class="c1"># required_args = {</span>
    <span class="c1">#     &quot;standard&quot;: [&quot;fname&quot;, &quot;output_product&quot;, &quot;compare_product&quot;],</span>
    <span class="c1">#     &quot;print_gunzip&quot;: [&quot;fobj&quot;, &quot;gunzip_fname&quot;],</span>
    <span class="c1">#     &quot;print_gzip&quot;: [&quot;fobj&quot;, &quot;gzip_fname&quot;],</span>
    <span class="c1"># }</span>
    <span class="c1"># required_kwargs = {&quot;standard&quot;: {}}</span>
    <span class="c1"># allowable_kwargs = {</span>
    <span class="c1">#     &quot;test_product&quot;: [&quot;goodcomps&quot;, &quot;badcomps&quot;, &quot;compare_strings&quot;],</span>
    <span class="c1">#     &quot;out_diffname&quot;: [&quot;ext&quot;, &quot;flag&quot;],</span>
    <span class="c1">#     &quot;compare_outputs&quot;: [&quot;test_product_func&quot;],</span>
    <span class="c1"># }</span>

<div class="viewcode-block" id="OutputCheckersInterface.identify_checker"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersInterface.identify_checker">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">identify_checker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify the correct output checker plugin and return its name.&quot;&quot;&quot;</span>
        <span class="n">checker_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">checker_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">is_gz</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="c1"># NOTE: this is the first time gunzip is run on the current</span>
            <span class="c1"># product, so ensure we clobber what is already there.</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">gunzip_product</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span> <span class="n">is_comparison_product</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clobber</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">output_checker</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plugins</span><span class="p">():</span>
            <span class="n">checker_found</span> <span class="o">=</span> <span class="n">output_checker</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">correct_file_format</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">checker_found</span><span class="p">:</span>
                <span class="n">checker_name</span> <span class="o">=</span> <span class="n">output_checker</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">name</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">checker_found</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;There isn&#39;t an output checker built for this data type.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">checker_name</span></div>

<div class="viewcode-block" id="OutputCheckersInterface.get_plugin"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersInterface.get_plugin">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_plugin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">rebuild_registries</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the output checker plugin corresponding to checker_name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            - The name the desired plugin.</span>
<span class="sd">        rebuild_registries: bool (default=None)</span>
<span class="sd">            - Whether or not to rebuild the registries if get_plugin fails. If set to</span>
<span class="sd">              None, default to what we have set in geoips.filenames.base_paths, which</span>
<span class="sd">              defaults to True. If specified, use the input value of rebuild_registries,</span>
<span class="sd">              which should be a boolean value. If rebuild registries is true and</span>
<span class="sd">              get_plugin fails, rebuild the plugin registry, call then call</span>
<span class="sd">              get_plugin once more with rebuild_registries toggled off, so it only gets</span>
<span class="sd">              rebuilt once.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plug</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_plugin</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">rebuild_registries</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_plugin</span><span class="p">(</span><span class="n">plug</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">plug</span></div>

<div class="viewcode-block" id="OutputCheckersInterface.valid_plugin"><a class="viewcode-back" href="../../../../geoips_api/geoips.interfaces.module_based.html#geoips.interfaces.module_based.output_checkers.OutputCheckersInterface.valid_plugin">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">valid_plugin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the validity of the supplied output_checker plugin.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;outputs_match&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;correct_file_format&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;call&quot;</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                <span class="s2">&quot;The plugin returned is missing one or more of the following functions.&quot;</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[outputs_match, correct_file_format, call]. Please create those &quot;</span>
                <span class="s2">&quot;before using this plugin.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div></div>


<span class="n">output_checkers</span> <span class="o">=</span> <span class="n">OutputCheckersInterface</span><span class="p">()</span>
</pre></div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="footer">
    <a href="http://www.navy.mil">Official US Navy Website</a>
    <a href="http://www.navy.com/navy/">US Navy Recruiting</a>
    <a href="http://www.nrlmry.navy.mil">NRL</a>
    <a href="http://foia.navy.mil">Accessibility</a>
    <a href="http://foia.navy.mil">Freedom of Information Act</a>
    <a href="http://www.nrlmry.navy.mil/privacypolicy.htm">Security & Policy</a>
    <a href="http://www.nrlmry.navy.mil/linknotice.html">Hyperlink Notice</a>
    <a href="mailto:webmaster@nrlmry.navy.mil">webmaster@nrlmry.navy.mil</a><br>
    <a href="http://www.nrlmry.navy.mil">
    Naval Research Laboratory Marine Meteorology Division Monterey, CA</a><br>
    7 Grace Hopper Avenue, STOP 2, Monterey, CA 93943-5502
</div></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>