.. dropdown:: Distribution Statement

 This source code is subject to the license referenced at
 https://github.com/NRLMMD-GEOIPS.

.. _configuration:

Configuring GeoIPS
******************

Like many other software packages, we offer the ability to precisely configure your
GeoIPS environment. This is largely done via environment variables. As referenced in our
:ref:`installation docs<installing-geoips>`, users must set a few environment variables
for GeoIPS to know where to read data from and where to store it (i.e.,
``$GEOIPS_TESTDATA_DIR`` and ``$GEOIPS_OUTDIRS``, respectively).

There are other types of environment variables as well that aren't specifically tied to
GeoIPS. For example, on a Linux machine you can set an ``$EDITOR`` environment variable
that specifies which text editor to use when opening a file. You'll notice that this
variable is a system-wide configuration rather than being tied to a specific software
package.

In the following sections, we'll detail GeoIPS-specific environment variables and
system-wide environment variables that GeoIPS recognizes.

GeoIPS Environment Variables
============================

The following environment variables are specific to GeoIPS and can be configured to control
how GeoIPS operates.

GEOIPS_TESTDATA_DIR
-------------------

``GEOIPS_TESTDATA_DIR`` specifies the directory where GeoIPS test data is stored. This
directory contains data used for testing and validating GeoIPS functionality. 
The test data is typically organized by sensor type and data format.

This variable must be set when running GeoIPS tests and producing example or
tutorial imagery.

**Example:**

.. code-block:: bash

    export GEOIPS_TESTDATA_DIR=$HOME/geoips_testdata

GEOIPS_PACKAGES_DIR
-------------------

``GEOIPS_PACKAGES_DIR`` specifies the directory that contains GeoIPS plugin packages. This
is the parent directory where all GeoIPS-related packages are installed, including the
core GeoIPS package and any additional plugin packages you may be using.

GeoIPS uses this variable in many of its helper scripts. If you have
multiple plugin packages (e.g., ``geoips``, ``data_fusion``, ``recenter_tc``) and 
you would like to make use of our testing scripts, they
should all be subdirectories of the path specified by ``GEOIPS_PACKAGES_DIR``.

**Example:**

.. code-block:: bash

    export GEOIPS_PACKAGES_DIR=$HOME/geoips_packages

GEOIPS_OUTDIRS
--------------

``GEOIPS_OUTDIRS`` specifies the base directory where GeoIPS will write output files.
This includes processed imagery, data products, and any other output generated by GeoIPS
processing workflows. The directory structure within ``GEOIPS_OUTDIRS`` is typically
organized by product type, date, and sensor.

If not set, this variable defaults to ``$HOME/GEOIPS_OUTDIRS``.

**Example:**

.. code-block:: bash

    export GEOIPS_OUTDIRS=$HOME/geoips_outdirs

Setting GeoIPS Environment Variables
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Below are examples of how to set these required GeoIPS environment variables for
different shells and environments.

**Bash:**

.. code-block:: bash

    # Edit your ~/.bashrc
    vim ~/.bashrc
    # Add the following lines to your .bashrc
    export GEOIPS_TESTDATA_DIR=$HOME/geoips_testdata
    export GEOIPS_PACKAGES_DIR=$HOME/geoips_packages
    export GEOIPS_OUTDIRS=$HOME/geoips_outdirs
    # Reload your configuration
    source ~/.bashrc

**Zsh:**

.. code-block:: zsh

    # Edit your ~/.zshrc
    vim ~/.zshrc
    # Add the following lines to your .zshrc
    export GEOIPS_TESTDATA_DIR=$HOME/geoips_testdata
    export GEOIPS_PACKAGES_DIR=$HOME/geoips_packages
    export GEOIPS_OUTDIRS=$HOME/geoips_outdirs
    # Reload your configuration
    source ~/.zshrc

**Fish:**

.. code-block:: fish

    # Edit your ~/.config/fish/config.fish
    vim ~/.config/fish/config.fish
    # Add the following lines to your config.fish
    set -x GEOIPS_TESTDATA_DIR $HOME/geoips_testdata
    set -x GEOIPS_PACKAGES_DIR $HOME/geoips_packages
    set -x GEOIPS_OUTDIRS $HOME/geoips_outdirs
    # Reload your configuration
    source ~/.config/fish/config.fish

**Nix:**

.. code-block:: nix

    # In your home.nix, configuration.nix or in a flake:
    home.sessionVariables = {
      GEOIPS_TESTDATA_DIR = "${config.home.homeDirectory}/geoips_testdata";
      GEOIPS_PACKAGES_DIR = "${config.home.homeDirectory}/geoips_packages";
      GEOIPS_OUTDIRS = "${config.home.homeDirectory}/geoips_outdirs";
    };

**Conda:**

For Conda environments, it's recommended to use conda config vars to set environment
variables when you activate your environment. This means the variables are only set
when the GeoIPS environment is active.

.. code-block:: bash
    # Set PACKAGES_DIR first
    conda env config vars set GEOIPS_PACKAGES_DIR=$HOME/geoips

    # Reactivate environment for variables to take effect
    conda deactivate && conda activate geoips
    conda env config vars set GEOIPS_TESTDATA_DIR=$GEOIPS_PACKAGES_DIR/test_data
    conda env config vars set GEOIPS_OUTDIRS=$GEOIPS_PACKAGES_DIR/outdirs
    conda deactivate && conda activate geoips

System-Wide Environment Variables
=================================

GeoIPS recognizes a subset of system-wide environment variables. We'll detail what each
variable accomplishes below.

NO_COLOR
--------

``NO_COLOR`` disables any colored output from your operating terminal. Many software
packages, including GeoIPS, may have commands that color certain portions of their
terminal output. Some users may not prefer this, and in that case, you can set this
variable to True in your ``.bashrc`` or comparable settings file.

.. note::
   Environment variable ``NO_COLOR`` will disable any colored output from the
   terminal, even if it's not produced via GeoIPS. For example, if this is set to
   True in your shell configuration, even pytest output will be monochrome. We chose
   this variable name as it is consistent with the settings that other software
   packages use.

Enabling this to True will prevent the GeoIPS command-line interface (CLI) from coloring
any of its terminal output (such as the beta warning after each GeoIPS command).

By default, if not set in your shell configuration, GeoIPS will not color any of its
terminal output.

To set this environment variable, there are two options:

Temporary
^^^^^^^^^

Running the appropriate command below will disable colored terminal output for a single
session.

**Bash/Zsh:**

.. code-block:: bash

    export NO_COLOR='True'

**Fish:**

.. code-block:: fish

    set -x NO_COLOR 'True'

**Nix:**

.. code-block:: nix

    # In a nix-shell or shell.nix
    shellHook = ''
      export NO_COLOR='True'
    '';

**Conda:**

.. code-block:: bash

    # With your conda environment activated
    export NO_COLOR='True'

Persistent
^^^^^^^^^^

Adding ``NO_COLOR`` to your ``GEOIPS`` enviormental variables - as
described above - will make your settings persistent.
    
    # Reactivate your environment for changes to take effect
    conda deactivate
    conda activate geoips
